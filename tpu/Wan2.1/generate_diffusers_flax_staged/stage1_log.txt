/home/chrisya/.local/lib/python3.12/site-packages/torch/amp/autocast_mode.py:270: UserWarning: User provided device_type of 'cuda', but CUDA is not available. Disabling
  warnings.warn(
Flax classes are deprecated and will be removed in Diffusers v1.0.0. We recommend migrating to PyTorch classes or pinning your version of Diffusers.
Flax classes are deprecated and will be removed in Diffusers v1.0.0. We recommend migrating to PyTorch classes or pinning your version of Diffusers.
âœ“ JAX ç¼–è¯‘ç¼“å­˜å·²å¯ç”¨: /dev/shm/jax_cache
æ³¨å†Œ PyTree èŠ‚ç‚¹...
  - BaseModelOutputWithPastAndCrossAttentions å·²æ³¨å†Œ
  - DecoderOutput å·²æ³¨å†Œ
  - AutoencoderKLOutput å·²æ³¨å†Œ
  - DiagonalGaussianDistribution å·²æ³¨å†Œ

============================================================
Wan 2.1 é˜¶æ®µ1ï¼šText Encoder (TPU)
============================================================

é…ç½®å‚æ•°ï¼š
  æ¨¡å‹: Wan-AI/Wan2.1-T2V-14B-Diffusers

=== åŠ è½½ Wan 2.1 T2V Pipeline ===
åŠ è½½æ¨¡å‹ä¸­ï¼ˆåœ¨å¯ç”¨ torchax ä¹‹å‰ï¼‰...
Loading pipeline components...:   0%|          | 0/5 [00:00<?, ?it/s]`torch_dtype` is deprecated! Use `dtype` instead!

Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s][A
Loading checkpoint shards:  20%|â–ˆâ–ˆ        | 1/5 [00:00<00:01,  3.70it/s][A
Loading checkpoint shards:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [00:00<00:01,  2.72it/s][A
Loading checkpoint shards:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:00<00:00,  3.42it/s][A
Loading checkpoint shards:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [00:01<00:00,  3.89it/s][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:01<00:00,  4.78it/s][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:01<00:00,  4.04it/s]
Loading pipeline components...:  20%|â–ˆâ–ˆ        | 1/5 [00:01<00:05,  1.26s/it]Loading pipeline components...:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [00:01<00:02,  1.43it/s]
Loading checkpoint shards:   0%|          | 0/12 [00:00<?, ?it/s][A
Loading checkpoint shards:  17%|â–ˆâ–‹        | 2/12 [00:00<00:00, 16.44it/s][A
Loading checkpoint shards:  33%|â–ˆâ–ˆâ–ˆâ–      | 4/12 [00:00<00:00, 15.14it/s][A
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [00:00<00:00, 15.71it/s][A
Loading checkpoint shards:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:00<00:00, 15.88it/s][A
Loading checkpoint shards:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 10/12 [00:00<00:00, 15.50it/s][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:00<00:00, 16.68it/s][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:00<00:00, 16.14it/s]
Loading pipeline components...:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [00:02<00:00,  1.94it/s]Loading pipeline components...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:02<00:00,  2.05it/s]
`loss_type=None` was set in the config but it is unrecognized. Using the default loss: `ForCausalLMLoss`.
âœ“ æ¨¡å‹åŠ è½½å®Œæˆ

å¯ç”¨ torchax...
Mesh: Mesh('dp': 2, 'tp': 4, axis_types=(Auto, Auto))

=== è®¾ç½® Text Encoder (TPU) ===
- ç§»åŠ¨ Text Encoder åˆ° TPU...
âœ“ Text Encoder è®¾ç½®å®Œæˆ


=== ç¼–ç æ–‡æœ¬æç¤ºè¯ ===
æ­£é¢ prompt: A cat and a dog baking a cake together in a kitchen. The cat is carefully measuring flour, while the...
è´Ÿé¢ prompt: Bright tones, overexposed, static, blurred details...

ç¼–ç  prompts...
  prompt_embeds shape: torch.Size([1, 226, 4096]), dtype: torch.bfloat16
  negative_prompt_embeds shape: torch.Size([1, 226, 4096])

è½¬æ¢ tensor åˆ° CPU...

ä¿å­˜ embeddings åˆ°: ./stage_outputs/stage1_embeddings.safetensors
âœ“ å·²ä¿å­˜ 2 ä¸ª tensors åˆ° ./stage_outputs/stage1_embeddings.safetensors
âœ“ å·²ä¿å­˜é…ç½®åˆ° ./stage_outputs/generation_config.json

============================================================
é˜¶æ®µ1 å®Œæˆï¼
============================================================

è¾“å‡ºæ–‡ä»¶ï¼š
  - Embeddings: ./stage_outputs/stage1_embeddings.safetensors
  - é…ç½®æ–‡ä»¶:   ./stage_outputs/generation_config.json

ä¿å­˜çš„ tensor shapesï¼š
  - prompt_embeds: torch.Size([1, 226, 4096])
  - negative_prompt_embeds: torch.Size([1, 226, 4096])

ä¸‹ä¸€æ­¥ï¼šè¿è¡Œ stage2_transformer.py è¿›è¡Œ Transformer æ¨ç†

âœ“ é˜¶æ®µ1 æ‰§è¡Œå®Œæˆ
