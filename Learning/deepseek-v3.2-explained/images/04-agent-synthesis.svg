<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 750">
  <defs>
    <linearGradient id="blueGrad4" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="greenGrad4" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#48bb78;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#38a169;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="orangeGrad4" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f6ad55;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ed8936;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="pinkGrad4" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f687b3;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#d53f8c;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="cyanGrad4" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4fd1c5;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#319795;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="purpleGrad4" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#9f7aea;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#805ad5;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow4" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="3" stdDeviation="2" flood-opacity="0.15"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="900" height="750" fill="#f8fafc"/>
  
  <!-- Title -->
  <text x="450" y="35" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#1a202c" text-anchor="middle">大规模 Agent 任务合成流程</text>
  
  <!-- Problem Statement -->
  <g transform="translate(50, 55)">
    <rect x="0" y="0" width="800" height="50" rx="10" fill="#fed7d7"/>
    <text x="400" y="20" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#c53030" text-anchor="middle">问题: 如何让模型在工具调用场景中也能进行深度推理?</text>
    <text x="400" y="38" font-family="Arial, sans-serif" font-size="11" fill="#9b2c2c" text-anchor="middle">开源模型在 Agent 场景的泛化和指令跟随能力远落后于闭源模型</text>
  </g>
  
  <!-- Phase 1: Cold Start -->
  <text x="450" y="135" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2d3748" text-anchor="middle">Phase 1: Cold-Start (冷启动)</text>
  
  <g transform="translate(50, 150)">
    <!-- Reasoning Data -->
    <g filter="url(#shadow4)">
      <rect x="0" y="0" width="180" height="90" rx="10" fill="url(#blueGrad4)"/>
      <text x="90" y="25" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white" text-anchor="middle">推理数据</text>
      <text x="90" y="45" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.9)" text-anchor="middle">&lt;think&gt;...&lt;/think&gt;</text>
      <text x="90" y="65" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.8)" text-anchor="middle">深度思考 + 答案</text>
      <text x="90" y="80" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.8)" text-anchor="middle">(非工具调用)</text>
    </g>
    
    <!-- Plus sign -->
    <text x="210" y="50" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#718096">+</text>
    
    <!-- Tool-Use Data -->
    <g filter="url(#shadow4)">
      <rect x="240" y="0" width="180" height="90" rx="10" fill="url(#greenGrad4)"/>
      <text x="330" y="25" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white" text-anchor="middle">工具调用数据</text>
      <text x="330" y="45" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.9)" text-anchor="middle">tool_call -> result</text>
      <text x="330" y="65" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.8)" text-anchor="middle">直接执行工具</text>
      <text x="330" y="80" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.8)" text-anchor="middle">(非推理模式)</text>
    </g>
    
    <!-- Arrow -->
    <path d="M430 45 L480 45" stroke="#718096" stroke-width="2" fill="none"/>
    <polygon points="480,40 490,45 480,50" fill="#718096"/>
    
    <!-- Prompt Engineering -->
    <g filter="url(#shadow4)">
      <rect x="500" y="0" width="160" height="90" rx="10" fill="url(#orangeGrad4)"/>
      <text x="580" y="25" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white" text-anchor="middle">Prompt 融合</text>
      <text x="580" y="50" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.9)" text-anchor="middle">设计统一 System</text>
      <text x="580" y="65" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.9)" text-anchor="middle">Prompt 指导模型</text>
      <text x="580" y="80" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.8)" text-anchor="middle">在推理中调用工具</text>
    </g>
    
    <!-- Arrow -->
    <path d="M665 45 L715 45" stroke="#718096" stroke-width="2" fill="none"/>
    <polygon points="715,40 725,45 715,50" fill="#718096"/>
    
    <!-- Result -->
    <g filter="url(#shadow4)">
      <rect x="735" y="0" width="115" height="90" rx="10" fill="url(#pinkGrad4)"/>
      <text x="792" y="30" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white" text-anchor="middle">初始能力</text>
      <text x="792" y="55" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.9)" text-anchor="middle">推理 + 工具</text>
      <text x="792" y="70" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.8)" text-anchor="middle">单轨迹融合</text>
    </g>
  </g>
  
  <!-- Phase 2: Large-Scale Synthesis -->
  <text x="450" y="285" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2d3748" text-anchor="middle">Phase 2: 大规模 Agent 任务合成</text>
  
  <!-- Four Agent Types -->
  <g transform="translate(30, 305)">
    <!-- Code Agent -->
    <g filter="url(#shadow4)">
      <rect x="0" y="0" width="200" height="120" rx="10" fill="url(#blueGrad4)"/>
      <text x="100" y="25" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">Code Agent</text>
      <text x="100" y="45" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)" text-anchor="middle">24,667 任务</text>
      
      <rect x="15" y="55" width="170" height="55" rx="6" fill="rgba(255,255,255,0.15)"/>
      <text x="100" y="72" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.9)" text-anchor="middle">GitHub Issue-PR 挖掘</text>
      <text x="100" y="87" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.8)" text-anchor="middle">Python/Java/JS/Go/C++</text>
      <text x="100" y="102" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.8)" text-anchor="middle">自动环境构建</text>
    </g>
    
    <!-- Search Agent -->
    <g filter="url(#shadow4)">
      <rect x="215" y="0" width="200" height="120" rx="10" fill="url(#greenGrad4)"/>
      <text x="315" y="25" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">Search Agent</text>
      <text x="315" y="45" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)" text-anchor="middle">50,275 任务</text>
      
      <rect x="230" y="55" width="170" height="55" rx="6" fill="rgba(255,255,255,0.15)"/>
      <text x="315" y="72" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.9)" text-anchor="middle">多智能体流水线生成</text>
      <text x="315" y="87" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.8)" text-anchor="middle">长尾实体 + QA构建</text>
      <text x="315" y="102" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.8)" text-anchor="middle">多语言多领域</text>
    </g>
    
    <!-- General Agent -->
    <g filter="url(#shadow4)">
      <rect x="430" y="0" width="200" height="120" rx="10" fill="url(#orangeGrad4)"/>
      <text x="530" y="25" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">General Agent</text>
      <text x="530" y="45" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)" text-anchor="middle">4,417 任务 / 1,827 环境</text>
      
      <rect x="445" y="55" width="170" height="55" rx="6" fill="rgba(255,255,255,0.15)"/>
      <text x="530" y="72" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.9)" text-anchor="middle">自动环境合成</text>
      <text x="530" y="87" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.8)" text-anchor="middle">难解决易验证的任务</text>
      <text x="530" y="102" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.8)" text-anchor="middle">如: 行程规划</text>
    </g>
    
    <!-- Code Interpreter -->
    <g filter="url(#shadow4)">
      <rect x="645" y="0" width="200" height="120" rx="10" fill="url(#purpleGrad4)"/>
      <text x="745" y="25" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">Code Interpreter</text>
      <text x="745" y="45" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.9)" text-anchor="middle">5,908 任务</text>
      
      <rect x="660" y="55" width="170" height="55" rx="6" fill="rgba(255,255,255,0.15)"/>
      <text x="745" y="72" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.9)" text-anchor="middle">Jupyter Notebook</text>
      <text x="745" y="87" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.8)" text-anchor="middle">数学/逻辑/数据科学</text>
      <text x="745" y="102" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.8)" text-anchor="middle">代码执行验证</text>
    </g>
  </g>
  
  <!-- Thinking Context Management -->
  <text x="450" y="465" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2d3748" text-anchor="middle">Thinking Context 管理机制</text>
  
  <g transform="translate(100, 480)">
    <rect x="0" y="0" width="700" height="120" rx="12" fill="#e2e8f0" filter="url(#shadow4)"/>
    
    <!-- Timeline -->
    <g transform="translate(30, 20)">
      <!-- Step 1 -->
      <g>
        <rect x="0" y="0" width="120" height="40" rx="6" fill="url(#blueGrad4)"/>
        <text x="60" y="18" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="white" text-anchor="middle">用户消息</text>
        <text x="60" y="32" font-family="Arial, sans-serif" font-size="8" fill="rgba(255,255,255,0.8)" text-anchor="middle">新问题开始</text>
      </g>
      <path d="M125 20 L155 20" stroke="#718096" stroke-width="2" fill="none"/>
      <polygon points="155,15 165,20 155,25" fill="#718096"/>
      
      <!-- Step 2 -->
      <g>
        <rect x="170" y="0" width="120" height="40" rx="6" fill="url(#greenGrad4)"/>
        <text x="230" y="18" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="white" text-anchor="middle">&lt;think&gt; 推理</text>
        <text x="230" y="32" font-family="Arial, sans-serif" font-size="8" fill="rgba(255,255,255,0.8)" text-anchor="middle">深度思考</text>
      </g>
      <path d="M295 20 L325 20" stroke="#718096" stroke-width="2" fill="none"/>
      <polygon points="325,15 335,20 325,25" fill="#718096"/>
      
      <!-- Step 3 -->
      <g>
        <rect x="340" y="0" width="120" height="40" rx="6" fill="url(#orangeGrad4)"/>
        <text x="400" y="18" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="white" text-anchor="middle">工具调用</text>
        <text x="400" y="32" font-family="Arial, sans-serif" font-size="8" fill="rgba(255,255,255,0.8)" text-anchor="middle">保留推理上下文</text>
      </g>
      <path d="M465 20 L495 20" stroke="#718096" stroke-width="2" fill="none"/>
      <polygon points="495,15 505,20 495,25" fill="#718096"/>
      
      <!-- Step 4 -->
      <g>
        <rect x="510" y="0" width="120" height="40" rx="6" fill="url(#pinkGrad4)"/>
        <text x="570" y="18" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="white" text-anchor="middle">工具结果</text>
        <text x="570" y="32" font-family="Arial, sans-serif" font-size="8" fill="rgba(255,255,255,0.8)" text-anchor="middle">继续推理</text>
      </g>
    </g>
    
    <!-- Key Points -->
    <g transform="translate(30, 70)">
      <circle cx="10" cy="10" r="5" fill="#48bb78"/>
      <text x="25" y="14" font-family="Arial, sans-serif" font-size="10" fill="#2d3748">工具消息不清空推理内容 - 避免重复推理,节省 Token</text>
      
      <circle cx="10" cy="35" r="5" fill="#e53e3e"/>
      <text x="25" y="39" font-family="Arial, sans-serif" font-size="10" fill="#2d3748">新用户消息才清空推理 - 工具调用历史保留</text>
    </g>
  </g>
  
  <!-- Results Summary -->
  <g transform="translate(50, 620)">
    <rect x="0" y="0" width="800" height="110" rx="12" fill="url(#cyanGrad4)" filter="url(#shadow4)"/>
    <text x="400" y="30" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">合成数据规模与成果</text>
    
    <g transform="translate(50, 50)">
      <g>
        <rect x="0" y="0" width="160" height="45" rx="6" fill="rgba(255,255,255,0.2)"/>
        <text x="80" y="20" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">1,800+ 环境</text>
        <text x="80" y="38" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.8)" text-anchor="middle">自动合成</text>
      </g>
      
      <g transform="translate(180, 0)">
        <rect x="0" y="0" width="160" height="45" rx="6" fill="rgba(255,255,255,0.2)"/>
        <text x="80" y="20" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">85,000+ 任务</text>
        <text x="80" y="38" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.8)" text-anchor="middle">多类型覆盖</text>
      </g>
      
      <g transform="translate(360, 0)">
        <rect x="0" y="0" width="160" height="45" rx="6" fill="rgba(255,255,255,0.2)"/>
        <text x="80" y="20" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">SWE-Bench 领先</text>
        <text x="80" y="38" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.8)" text-anchor="middle">代码 Agent 能力</text>
      </g>
      
      <g transform="translate(540, 0)">
        <rect x="0" y="0" width="160" height="45" rx="6" fill="rgba(255,255,255,0.2)"/>
        <text x="80" y="20" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">泛化能力强</text>
        <text x="80" y="38" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.8)" text-anchor="middle">长尾任务表现优</text>
      </g>
    </g>
  </g>
</svg>