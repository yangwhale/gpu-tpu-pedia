<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 450">
  <defs>
    <linearGradient id="mtpBlue" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="mtpGreen" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#48bb78;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#38a169;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="mtpOrange" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ed8936;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#dd6b20;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="mtpPink" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ed64a6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#d53f8c;stop-opacity:1" />
    </linearGradient>
    <filter id="shadowMtp" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="2" flood-opacity="0.15"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="900" height="450" fill="#f7fafc"/>
  
  <!-- Title -->
  <text x="450" y="35" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#2d3748" text-anchor="middle">Multi-Token Prediction (MTP)</text>
  <text x="450" y="58" font-family="Arial, sans-serif" font-size="13" fill="#718096" text-anchor="middle">不只预测下一个 token，而是预测后续多个 token | 提升数据效率 + 支持 Speculative Decoding</text>
  
  <!-- Traditional Next Token Prediction -->
  <rect x="50" y="80" width="380" height="150" rx="10" fill="white" stroke="#e2e8f0" stroke-width="2" filter="url(#shadowMtp)"/>
  <text x="240" y="105" font-family="Arial, sans-serif" font-size="14" fill="#4a5568" text-anchor="middle" font-weight="bold">传统: Next Token Prediction</text>
  
  <!-- Input sequence -->
  <rect x="80" y="125" width="50" height="35" rx="5" fill="url(#mtpBlue)" filter="url(#shadowMtp)"/>
  <text x="105" y="148" font-family="Arial, sans-serif" font-size="11" fill="white" text-anchor="middle">我</text>
  
  <rect x="140" y="125" width="50" height="35" rx="5" fill="url(#mtpBlue)" filter="url(#shadowMtp)"/>
  <text x="165" y="148" font-family="Arial, sans-serif" font-size="11" fill="white" text-anchor="middle">喜</text>
  
  <rect x="200" y="125" width="50" height="35" rx="5" fill="url(#mtpBlue)" filter="url(#shadowMtp)"/>
  <text x="225" y="148" font-family="Arial, sans-serif" font-size="11" fill="white" text-anchor="middle">欢</text>
  
  <text x="275" y="148" font-family="Arial, sans-serif" font-size="14" fill="#718096">→</text>
  
  <!-- Single prediction -->
  <rect x="295" y="125" width="50" height="35" rx="5" fill="url(#mtpGreen)" filter="url(#shadowMtp)"/>
  <text x="320" y="148" font-family="Arial, sans-serif" font-size="11" fill="white" text-anchor="middle">吃</text>
  
  <text x="360" y="148" font-family="Arial, sans-serif" font-size="12" fill="#718096">?</text>
  <text x="385" y="148" font-family="Arial, sans-serif" font-size="12" fill="#a0aec0">?</text>
  
  <text x="240" y="195" font-family="Arial, sans-serif" font-size="11" fill="#718096" text-anchor="middle">每个位置只预测 1 个 token</text>
  <text x="240" y="215" font-family="Arial, sans-serif" font-size="11" fill="#e53e3e" text-anchor="middle">信号稀疏，数据效率低</text>
  
  <!-- MTP -->
  <rect x="470" y="80" width="380" height="150" rx="10" fill="white" stroke="#38a169" stroke-width="2" filter="url(#shadowMtp)"/>
  <text x="660" y="105" font-family="Arial, sans-serif" font-size="14" fill="#276749" text-anchor="middle" font-weight="bold">DeepSeek-V3: Multi-Token Prediction</text>
  
  <!-- Input sequence -->
  <rect x="500" y="125" width="50" height="35" rx="5" fill="url(#mtpBlue)" filter="url(#shadowMtp)"/>
  <text x="525" y="148" font-family="Arial, sans-serif" font-size="11" fill="white" text-anchor="middle">我</text>
  
  <rect x="560" y="125" width="50" height="35" rx="5" fill="url(#mtpBlue)" filter="url(#shadowMtp)"/>
  <text x="585" y="148" font-family="Arial, sans-serif" font-size="11" fill="white" text-anchor="middle">喜</text>
  
  <rect x="620" y="125" width="50" height="35" rx="5" fill="url(#mtpBlue)" filter="url(#shadowMtp)"/>
  <text x="645" y="148" font-family="Arial, sans-serif" font-size="11" fill="white" text-anchor="middle">欢</text>
  
  <text x="690" y="148" font-family="Arial, sans-serif" font-size="14" fill="#718096">→</text>
  
  <!-- Multiple predictions -->
  <rect x="710" y="120" width="45" height="28" rx="4" fill="url(#mtpGreen)" filter="url(#shadowMtp)"/>
  <text x="732" y="139" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">吃</text>
  
  <rect x="765" y="120" width="45" height="28" rx="4" fill="url(#mtpOrange)" filter="url(#shadowMtp)"/>
  <text x="787" y="139" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">苹</text>
  
  <rect x="710" y="155" width="45" height="28" rx="4" fill="url(#mtpPink)" filter="url(#shadowMtp)"/>
  <text x="732" y="174" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">果</text>
  
  <text x="780" y="174" font-family="Arial, sans-serif" font-size="10" fill="#718096">...</text>
  
  <text x="660" y="205" font-family="Arial, sans-serif" font-size="11" fill="#38a169" text-anchor="middle">每个位置预测 D 个后续 token</text>
  <text x="660" y="220" font-family="Arial, sans-serif" font-size="11" fill="#38a169" text-anchor="middle">信号密集，数据效率高!</text>
  
  <!-- MTP Architecture Detail -->
  <rect x="50" y="250" width="800" height="170" rx="10" fill="white" stroke="#667eea" stroke-width="2" filter="url(#shadowMtp)"/>
  <text x="450" y="275" font-family="Arial, sans-serif" font-size="14" fill="#4a5568" text-anchor="middle" font-weight="bold">MTP 模块架构 (保持完整因果链)</text>
  
  <!-- Main model output -->
  <rect x="100" y="300" width="100" height="40" rx="6" fill="url(#mtpBlue)" filter="url(#shadowMtp)"/>
  <text x="150" y="318" font-family="Arial, sans-serif" font-size="11" fill="white" text-anchor="middle" font-weight="bold">主模型输出</text>
  <text x="150" y="332" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.8)" text-anchor="middle">h^0_t</text>
  
  <!-- Embedding of next token -->
  <rect x="100" y="355" width="100" height="40" rx="6" fill="#e2e8f0" filter="url(#shadowMtp)"/>
  <text x="150" y="373" font-family="Arial, sans-serif" font-size="10" fill="#4a5568" text-anchor="middle">Emb(t_{i+1})</text>
  <text x="150" y="387" font-family="Arial, sans-serif" font-size="9" fill="#718096" text-anchor="middle">下一个 token 嵌入</text>
  
  <!-- Combine -->
  <circle cx="250" cy="340" r="20" fill="url(#mtpGreen)" filter="url(#shadowMtp)"/>
  <text x="250" y="345" font-family="Arial, sans-serif" font-size="14" fill="white" text-anchor="middle">+</text>
  
  <!-- Arrows -->
  <path d="M200 320 L230 340" stroke="#667eea" stroke-width="2" fill="none"/>
  <path d="M200 375 L230 345" stroke="#718096" stroke-width="2" fill="none"/>
  
  <!-- Linear projection -->
  <rect x="290" y="320" width="80" height="40" rx="6" fill="url(#mtpOrange)" filter="url(#shadowMtp)"/>
  <text x="330" y="342" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" font-weight="bold">M_k 投影</text>
  <text x="330" y="355" font-family="Arial, sans-serif" font-size="8" fill="rgba(255,255,255,0.8)" text-anchor="middle">Linear(2d→d)</text>
  
  <path d="M270 340 L290 340" stroke="#48bb78" stroke-width="2" fill="none"/>
  
  <!-- MTP Transformer block -->
  <rect x="400" y="320" width="100" height="40" rx="6" fill="url(#mtpPink)" filter="url(#shadowMtp)"/>
  <text x="450" y="338" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" font-weight="bold">TRM_k</text>
  <text x="450" y="352" font-family="Arial, sans-serif" font-size="8" fill="rgba(255,255,255,0.8)" text-anchor="middle">Transformer Block</text>
  
  <path d="M370 340 L400 340" stroke="#ed8936" stroke-width="2" fill="none"/>
  
  <!-- Output head -->
  <rect x="530" y="320" width="100" height="40" rx="6" fill="url(#mtpBlue)" filter="url(#shadowMtp)"/>
  <text x="580" y="338" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" font-weight="bold">OutHead</text>
  <text x="580" y="352" font-family="Arial, sans-serif" font-size="8" fill="rgba(255,255,255,0.8)" text-anchor="middle">共享 LM Head</text>
  
  <path d="M500 340 L530 340" stroke="#d53f8c" stroke-width="2" fill="none"/>
  
  <!-- Prediction output -->
  <rect x="660" y="320" width="80" height="40" rx="6" fill="url(#mtpGreen)" filter="url(#shadowMtp)"/>
  <text x="700" y="338" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" font-weight="bold">P^k_{i+k+1}</text>
  <text x="700" y="352" font-family="Arial, sans-serif" font-size="8" fill="rgba(255,255,255,0.8)" text-anchor="middle">第 k 个预测</text>
  
  <path d="M630 340 L660 340" stroke="#667eea" stroke-width="2" fill="none"/>
  
  <!-- Note: repeat for D depths -->
  <text x="780" y="340" font-family="Arial, sans-serif" font-size="12" fill="#718096">×D</text>
  
  <!-- Benefits -->
  <rect x="100" y="405" width="200" height="30" rx="6" fill="#c6f6d5"/>
  <text x="200" y="425" font-family="Arial, sans-serif" font-size="11" fill="#276749" text-anchor="middle" font-weight="bold">训练: 密集信号，更好性能</text>
  
  <rect x="350" y="405" width="200" height="30" rx="6" fill="#bee3f8"/>
  <text x="450" y="425" font-family="Arial, sans-serif" font-size="11" fill="#2b6cb0" text-anchor="middle" font-weight="bold">推理: 可丢弃 MTP 模块</text>
  
  <rect x="600" y="405" width="200" height="30" rx="6" fill="#fef3c7"/>
  <text x="700" y="425" font-family="Arial, sans-serif" font-size="11" fill="#744210" text-anchor="middle" font-weight="bold">加速: Speculative Decoding</text>
</svg>