<?xml version="1.0" encoding="UTF-8"?>
<svg width="900" height="550" viewBox="0 0 900 550" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="blueGrad3" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea"/>
      <stop offset="100%" style="stop-color:#764ba2"/>
    </linearGradient>
    <linearGradient id="greenGrad3" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#48bb78"/>
      <stop offset="100%" style="stop-color:#38a169"/>
    </linearGradient>
    <linearGradient id="orangeGrad3" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ed8936"/>
      <stop offset="100%" style="stop-color:#dd6b20"/>
    </linearGradient>
    <linearGradient id="redGrad3" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#fc8181"/>
      <stop offset="100%" style="stop-color:#e53e3e"/>
    </linearGradient>
    <filter id="shadow3" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.2"/>
    </filter>
  </defs>
  
  <!-- 标题 -->
  <text x="450" y="35" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#333" text-anchor="middle">注意力机制演进对比</text>
  <text x="450" y="58" font-family="Arial, sans-serif" font-size="13" fill="#666" text-anchor="middle">从标准注意力到线性注意力的发展路径</text>
  
  <!-- 第一行: 标准注意力 -->
  <rect x="30" y="80" width="200" height="200" rx="12" fill="white" stroke="#e53e3e" stroke-width="3" filter="url(#shadow3)"/>
  <rect x="30" y="80" width="200" height="40" rx="12" fill="url(#redGrad3)"/>
  <text x="130" y="107" font-family="Arial, sans-serif" font-size="14" fill="white" text-anchor="middle" font-weight="bold">标准注意力 (SA)</text>
  
  <text x="50" y="145" font-family="Arial, sans-serif" font-size="12" fill="#333">复杂度: O(T²)</text>
  <text x="50" y="165" font-family="Arial, sans-serif" font-size="12" fill="#333">KV Cache: O(T)</text>
  <text x="50" y="185" font-family="Arial, sans-serif" font-size="12" fill="#333">位置编码: RoPE</text>
  <line x1="50" y1="200" x2="210" y2="200" stroke="#ddd" stroke-width="1"/>
  <text x="50" y="220" font-family="Arial, sans-serif" font-size="11" fill="#666">✓ 精确检索</text>
  <text x="50" y="238" font-family="Arial, sans-serif" font-size="11" fill="#666">✓ 表达能力强</text>
  <text x="50" y="256" font-family="Arial, sans-serif" font-size="11" fill="#e53e3e">✗ 长序列慢</text>
  <text x="50" y="274" font-family="Arial, sans-serif" font-size="11" fill="#e53e3e">✗ 内存占用大</text>
  
  <!-- 第二行: 线性注意力 -->
  <rect x="250" y="80" width="200" height="200" rx="12" fill="white" stroke="#ed8936" stroke-width="3" filter="url(#shadow3)"/>
  <rect x="250" y="80" width="200" height="40" rx="12" fill="url(#orangeGrad3)"/>
  <text x="350" y="107" font-family="Arial, sans-serif" font-size="14" fill="white" text-anchor="middle" font-weight="bold">线性注意力 (LA)</text>
  
  <text x="270" y="145" font-family="Arial, sans-serif" font-size="12" fill="#333">复杂度: O(T)</text>
  <text x="270" y="165" font-family="Arial, sans-serif" font-size="12" fill="#333">状态: 固定大小</text>
  <text x="270" y="185" font-family="Arial, sans-serif" font-size="12" fill="#333">S_t = S_{t-1} + k·v^T</text>
  <line x1="270" y1="200" x2="430" y2="200" stroke="#ddd" stroke-width="1"/>
  <text x="270" y="220" font-family="Arial, sans-serif" font-size="11" fill="#666">✓ 速度快</text>
  <text x="270" y="238" font-family="Arial, sans-serif" font-size="11" fill="#666">✓ 内存固定</text>
  <text x="270" y="256" font-family="Arial, sans-serif" font-size="11" fill="#e53e3e">✗ 无遗忘机制</text>
  <text x="270" y="274" font-family="Arial, sans-serif" font-size="11" fill="#e53e3e">✗ 表达能力弱</text>
  
  <!-- 第三行: GLA/Mamba2 -->
  <rect x="470" y="80" width="200" height="200" rx="12" fill="white" stroke="#48bb78" stroke-width="3" filter="url(#shadow3)"/>
  <rect x="470" y="80" width="200" height="40" rx="12" fill="url(#greenGrad3)"/>
  <text x="570" y="107" font-family="Arial, sans-serif" font-size="14" fill="white" text-anchor="middle" font-weight="bold">GLA / Mamba2</text>
  
  <text x="490" y="145" font-family="Arial, sans-serif" font-size="12" fill="#333">复杂度: O(T)</text>
  <text x="490" y="165" font-family="Arial, sans-serif" font-size="12" fill="#333">遗忘门: Diag(α_t)</text>
  <text x="490" y="185" font-family="Arial, sans-serif" font-size="12" fill="#333">S_t = α·S_{t-1} + k·v^T</text>
  <line x1="490" y1="200" x2="650" y2="200" stroke="#ddd" stroke-width="1"/>
  <text x="490" y="220" font-family="Arial, sans-serif" font-size="11" fill="#666">✓ 有遗忘机制</text>
  <text x="490" y="238" font-family="Arial, sans-serif" font-size="11" fill="#666">✓ 细粒度控制</text>
  <text x="490" y="256" font-family="Arial, sans-serif" font-size="11" fill="#e53e3e">✗ 无纠错能力</text>
  <text x="490" y="274" font-family="Arial, sans-serif" font-size="11" fill="#e53e3e">✗ 检索能力弱</text>
  
  <!-- 第四行: Gated DeltaNet -->
  <rect x="690" y="80" width="200" height="200" rx="12" fill="white" stroke="#667eea" stroke-width="3" filter="url(#shadow3)"/>
  <rect x="690" y="80" width="200" height="40" rx="12" fill="url(#blueGrad3)"/>
  <text x="790" y="107" font-family="Arial, sans-serif" font-size="14" fill="white" text-anchor="middle" font-weight="bold">Gated DeltaNet</text>
  
  <text x="710" y="145" font-family="Arial, sans-serif" font-size="12" fill="#333">复杂度: O(T)</text>
  <text x="710" y="165" font-family="Arial, sans-serif" font-size="12" fill="#333">遗忘: 标量 α_t</text>
  <text x="710" y="185" font-family="Arial, sans-serif" font-size="12" fill="#333">+ Delta Rule 纠错</text>
  <line x1="710" y1="200" x2="870" y2="200" stroke="#ddd" stroke-width="1"/>
  <text x="710" y="220" font-family="Arial, sans-serif" font-size="11" fill="#666">✓ 遗忘 + 纠错</text>
  <text x="710" y="238" font-family="Arial, sans-serif" font-size="11" fill="#666">✓ WY 并行化</text>
  <text x="710" y="256" font-family="Arial, sans-serif" font-size="11" fill="#e53e3e">✗ 遗忘粒度粗</text>
  <text x="710" y="274" font-family="Arial, sans-serif" font-size="11" fill="#666">○ 表达能力中等</text>
  
  <!-- 箭头 -->
  <path d="M230 180 L250 180" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <path d="M450 180 L470 180" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <path d="M670 180 L690 180" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- KDA (主角) -->
  <rect x="300" y="320" width="300" height="210" rx="15" fill="white" stroke="#764ba2" stroke-width="4" filter="url(#shadow3)"/>
  <rect x="300" y="320" width="300" height="50" rx="15" fill="url(#blueGrad3)"/>
  <text x="450" y="350" font-family="Arial, sans-serif" font-size="18" fill="white" text-anchor="middle" font-weight="bold">🌟 Kimi Delta Attention (KDA)</text>
  
  <text x="320" y="395" font-family="Arial, sans-serif" font-size="13" fill="#333" font-weight="bold">核心创新:</text>
  <text x="320" y="415" font-family="Arial, sans-serif" font-size="12" fill="#333">• 细粒度通道级遗忘门 Diag(α_t)</text>
  <text x="320" y="435" font-family="Arial, sans-serif" font-size="12" fill="#333">• Delta Rule 纠错机制</text>
  <text x="320" y="455" font-family="Arial, sans-serif" font-size="12" fill="#333">• 高效 DPLR 变体 (比通用快 2×)</text>
  
  <line x1="320" y1="470" x2="580" y2="470" stroke="#ddd" stroke-width="1"/>
  
  <text x="320" y="490" font-family="Arial, sans-serif" font-size="12" fill="#48bb78">✓ 精确记忆控制</text>
  <text x="320" y="510" font-family="Arial, sans-serif" font-size="12" fill="#48bb78">✓ 硬件高效</text>
  <text x="450" y="490" font-family="Arial, sans-serif" font-size="12" fill="#48bb78">✓ 强检索能力</text>
  <text x="450" y="510" font-family="Arial, sans-serif" font-size="12" fill="#48bb78">✓ 类 RoPE 位置编码</text>
  
  <!-- 从 GDN 到 KDA 的箭头 -->
  <path d="M790 280 L790 320 L600 320 L600 380" stroke="#764ba2" stroke-width="3" fill="none" stroke-dasharray="8,4"/>
  <text x="700" y="300" font-family="Arial, sans-serif" font-size="11" fill="#764ba2">升级</text>
  
  <!-- 公式对比 -->
  <rect x="640" y="350" width="240" height="170" rx="10" fill="#f7fafc" stroke="#e2e8f0" stroke-width="2"/>
  <text x="760" y="375" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#333" text-anchor="middle">公式对比</text>
  
  <text x="660" y="400" font-family="Arial, sans-serif" font-size="11" fill="#666">GDN (标量门):</text>
  <text x="660" y="420" font-family="monospace" font-size="10" fill="#999">S = α(I-βkk^T)S + βkv^T</text>
  
  <text x="660" y="450" font-family="Arial, sans-serif" font-size="11" fill="#764ba2" font-weight="bold">KDA (通道门):</text>
  <text x="660" y="470" font-family="monospace" font-size="10" fill="#333">S = (I-βkk^T)Diag(α)S</text>
  <text x="660" y="490" font-family="monospace" font-size="10" fill="#333">  + βkv^T</text>
  
  <text x="760" y="515" font-family="Arial, sans-serif" font-size="10" fill="#48bb78" text-anchor="middle">每维度独立遗忘!</text>
</svg>
